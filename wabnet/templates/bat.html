{% extends "base.html" %}
{% load render_table from django_tables2 %}

{% block title %}Bat Data{% endblock %}

{% block content %}
    <div class="panel panel-primary metadata">
        <div class="panel-heading">Metadata</div>
        <dl class="panel-body">
            <dt>Created By:</dt>
            <dd>{{ bat_data.created_by }}</dd>
            <dt>Created At:</dt>
            <dd>{{ bat_data.created_at }}</dd>
        </dl>
    </div>
    <h1>{{bat_data.title}}</h1>
    <div class="model-data panel panel-primary">
        <div class="panel-heading">Primary Bat Data</div>
        <dl class="panel-body">
            {% for field, value in main_data %}
                <dt>{{ field.verbose_name }}</dt>
                <dd>
                    {% if value.url|length > 0 %}
                        <a href="{{ value.url }}">{{value.url}}</a>
                    {% else %}
                        {{ value }}
                    {% endif %}
                </dd>
            {% endfor %}
            <dt>Bat Species:</dt>
            <dd>{{ bat_species }}</dd>
        </dl>
    </div>

    <div class="model-data panel panel-primary">
        <div class="panel-heading">
            Secondary Data Table
            <a class="attach-data" href="{% url 'attach_data' bat_data.uuid %}" role="button">
                Attach Secondary Data
            </a>
        </div>
        <div class="panel-body">
        {% render_table secondary_data_table %}
        </div>
    </div>

    {% for table in tables %}
        <div class="model-data panel panel-primary">
            <div class="panel-heading">{{table.name}}</div>
            <div class="panel-body">
                {% render_table table %}
            </div>
        </div>
    {% endfor %}

    <div class="model-data panel panel-primary">
        <div class="panel-heading">Trapping Event Data</div>
        <dl class="panel-body">
            <dt>Site</dt>
            <dd><a href="{% url 'sites' bat_data.parent.parent.uuid %}">{{ bat_data.parent.parent.title }}</a></dd>
            {% for field in trapping_event_form %}
                <dt>{{ field.label_tag }}</dt>
                <dd>
                    {% with field.value as value %}
                    {% if value.url|length > 0 %}
                        <a href="{{ value.url }}">{{value.url}}</a>
                    {% else %}
                        {{ value }}
                    {% endif %}
                    {% endwith %}
                </dd>
            {% endfor %}
        </dl>
    </div>

{% endblock %}
